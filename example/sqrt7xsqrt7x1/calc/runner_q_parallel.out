########################
###### START MAIN ######
########################

Start mapping quc+guc <-> qsc+gsc

2-(a). q0sc <-> q0uc
2-(a). q0sc <-> q0uc Done
2-(b). q0sc <-> quc
2-(b). q0sc <-> quc Done
2-(c). qsc <-> quc
      *iqsc = 0 out of 8
      *iqsc = 1 out of 8
      *iqsc = 2 out of 8
      *iqsc = 3 out of 8
      *iqsc = 4 out of 8
      *iqsc = 5 out of 8
      *iqsc = 6 out of 8
      *iqsc = 7 out of 8
2-(c). qsc <-> quc Done

End of mapping quc+guc <-> qsc+gsc


########################
####### ADD Chi ########
########################



Zero out ../sc/3.1-chi-separate/Eps_0/chi0mat.h5

Start adding matrix elements


Working on  ../sc/3.1-chi-separate/./Eps_0/chi0mat.h5

Note, this is a special point q0sc

Parallel over quc

Number of quc in the master processor: 4
iquc_l: 0 out of 7
We are constructing q0sc from q0uc!
iquc_l: 1 out of 7
iquc_l: 2 out of 7
iquc_l: 3 out of 7

End of adding matrix elements


Sanity check
target:  ../sc/3.1-chi-separate_backup/Eps_0/chi0mat.h5

constructed
[-2.33061482e-08+0.00000000e+00j  2.19798607e-08+2.51007212e-12j
  2.19791734e-08-2.85245058e-12j -1.84400537e-08-4.13213488e-12j
 -1.84389737e-08+5.34915435e-12j  1.37818005e-08+4.57467750e-12j
  1.37807395e-08-6.82326642e-12j  0.00000000e+00+0.00000000e+00j
  0.00000000e+00+0.00000000e+00j  0.00000000e+00+0.00000000e+00j
  0.00000000e+00+0.00000000e+00j  0.00000000e+00+0.00000000e+00j
  0.00000000e+00+0.00000000e+00j  0.00000000e+00+0.00000000e+00j
  0.00000000e+00+0.00000000e+00j  0.00000000e+00+0.00000000e+00j
  0.00000000e+00+0.00000000e+00j  0.00000000e+00+0.00000000e+00j
  0.00000000e+00+0.00000000e+00j  0.00000000e+00+0.00000000e+00j]

target
[-2.34023095e-08+0.00000000e+00j  2.21200292e-08+2.62767769e-07j
  2.21201362e-08-2.62767994e-07j -1.86792138e-08-4.59406261e-07j
 -1.86793945e-08+4.59407046e-07j  1.40983906e-08+5.45987298e-07j
  1.40985949e-08-5.45988693e-07j  9.28729479e-09-2.22699088e-08j
  9.25250301e-09+2.21492351e-08j -5.66357657e-09-9.10831699e-09j
 -5.65875872e-09+9.12698496e-09j -3.14042292e-10+2.58976661e-08j
 -3.05317879e-10-2.58509870e-08j -8.71356371e-09+2.16768022e-08j
 -9.14560039e-09+2.13827101e-08j -9.10765338e-09-2.12718085e-08j
 -8.67568464e-09-2.15648497e-08j  5.34614971e-09+9.00880861e-09j
  5.72868517e-09+8.88678415e-09j  5.72111108e-09-8.90230132e-09j]

|subtract|
[9.61613800e-11 2.62765296e-07 2.62765179e-07 4.59402191e-07
 4.59401760e-07 5.45982815e-07 5.45981963e-07 2.41288766e-08
 2.40041127e-08 1.07255554e-08 1.07388735e-08 2.58995701e-08
 2.58527899e-08 2.33625758e-08 2.32564464e-08 2.31395589e-08
 2.32445746e-08 1.04756837e-08 1.05732098e-08 1.05821586e-08]

np.max(subtract)
5.675488841604215e-06
